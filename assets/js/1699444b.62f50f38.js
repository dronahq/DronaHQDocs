"use strict";(self.webpackChunkdronahq_docs=self.webpackChunkdronahq_docs||[]).push([[44393],{97574:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>u,contentTitle:()=>p,default:()=>k,frontMatter:()=>s,metadata:()=>d,toc:()=>c});n(67294);var a=n(3905),i=n(86291);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})),t}function l(t,e){if(null==t)return{};var n,a,i=function(t,e){if(null==t)return{};var n,a,i={},r=Object.keys(t);for(a=0;a<r.length;a++)n=r[a],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(a=0;a<r.length;a++)n=r[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}const s={sidebar_position:1},p="Configure Microsoft Entra ID SAML",d={unversionedId:"sso-guides/configure-microsoft-entra-saml",id:"sso-guides/configure-microsoft-entra-saml",title:"Configure Microsoft Entra ID SAML",description:"Use this guide to configure Microsoft Entra ID SSO with SAML on DronaHQ. Once configured, users can log in to DronaHQ with their Microsoft Entra ID credentials.",source:"@site/docs/sso-guides/configure-microsoft-entra-saml.md",sourceDirName:"sso-guides",slug:"/sso-guides/configure-microsoft-entra-saml",permalink:"/sso-guides/configure-microsoft-entra-saml",draft:!1,tags:[],version:"current",lastUpdatedAt:1723461704,formattedLastUpdatedAt:"Aug 12, 2024",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"docSidebar",previous:{title:"Configure Microsoft Entra ID OIDC",permalink:"/sso-guides/configure-microsoft-entra-oidc"},next:{title:"Configure Okta OIDC",permalink:"/sso-guides/configure-okta-oidc"}},u={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Setting up Microsoft Entra ID",id:"setting-up-microsoft-entra-id",level:2},{value:"Assign users to the DronaHQ application in Azure",id:"assign-users-to-the-dronahq-application-in-azure",level:2},{value:"Configure SAML Settings in Azure",id:"configure-saml-settings-in-azure",level:2},{value:"Configure in DronaHQ",id:"configure-in-dronahq",level:2},{value:"Microsoft Entra ID SAML in Action",id:"microsoft-entra-id-saml-in-action",level:2}],m={toc:c},g="wrapper";function k(t){var{components:e}=t,n=l(t,["components"]);return(0,a.kt)(g,o(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),a.forEach((function(e){r(t,e,n[e])}))}return t}({},m,n),{components:e,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"configure-microsoft-entra-id-saml"},"Configure Microsoft Entra ID SAML"),(0,a.kt)("p",null,"Use this guide to configure Microsoft Entra ID SSO with SAML on DronaHQ. Once configured, users can log in to DronaHQ with their Microsoft Entra ID credentials."),(0,a.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,a.kt)("p",null,"To set up Microsoft Entra ID SAML in DronaHQ, you will need:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Permissions to create an Microsoft Entra ID Enterprise application."),(0,a.kt)("li",{parentName:"ol"},"Manage Users access on self-hosted DronaHQ instance or DronaHQ Cloud to configure SSO configurations.")),(0,a.kt)("h2",{id:"setting-up-microsoft-entra-id"},"Setting up Microsoft Entra ID"),(0,a.kt)("p",null,"To create an Microsoft Entra ID Enterprise application, follow the steps in ",(0,a.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/entra/identity/enterprise-apps/add-application-portal-setup-sso"},"this documentation"),"."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"In the ",(0,a.kt)("inlineCode",{parentName:"p"},"Microsoft Entra ID portal"),", add a new ",(0,a.kt)("inlineCode",{parentName:"p"},"Enterprise application"),".")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"DronaHQ is not listed in the Microsoft Entra ID Gallery, so select ",(0,a.kt)("inlineCode",{parentName:"p"},"Create your own application"),".")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Give User friendly Name for the application to identify SSO for DronaHQ. ")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Select ",(0,a.kt)("inlineCode",{parentName:"p"},"Integrate any other application you don\u2019t find in the gallery (Non-gallery)"),"."))),(0,a.kt)("h2",{id:"assign-users-to-the-dronahq-application-in-azure"},"Assign users to the DronaHQ application in Azure"),(0,a.kt)("p",null,"For users to access DronaHQ using Microsoft Entra ID SSO, they must:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Be assigned to the application"),(0,a.kt)("li",{parentName:"ul"},"Have a Name and Email defined on their profile")),(0,a.kt)("p",null,"Assign users to the DronaHQ application and confirm their required attributes in the ",(0,a.kt)("inlineCode",{parentName:"p"},"Microsoft Entra ID admin center"),"."),(0,a.kt)("h2",{id:"configure-saml-settings-in-azure"},"Configure SAML Settings in Azure"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Download and open DronaHQ metadata file. To locate this file, Go to ",(0,a.kt)("inlineCode",{parentName:"li"},"DronaHQ -> Manage Users -> SSO CONFIGURATION -> + Add SSO -> SAML 2.0"),". Under ",(0,a.kt)("inlineCode",{parentName:"li"},"Entity ID and Metadata URL"),", open this url file that will be useful in next steps. "),(0,a.kt)("li",{parentName:"ol"},"In the ",(0,a.kt)("inlineCode",{parentName:"li"},"Microsoft Entra ID admin center"),", select the ",(0,a.kt)("inlineCode",{parentName:"li"},"DronaHQ")," Enterprise application. Set up single sign on for the DronaHQ application, selecting ",(0,a.kt)("inlineCode",{parentName:"li"},"SAML")," as the sign-on method. Use the following SAML settings. Leave Relay state and Logout URL blank.")),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Setting"),(0,a.kt)("th",{parentName:"tr",align:null},"Value"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Identifier (Entity ID)"),(0,a.kt)("td",{parentName:"tr",align:null},"Locate this in DronaHQ metadata file downloaded above. For eg - ",(0,a.kt)("a",{parentName:"td",href:"https://studio.dronahq.com/saml/metadata"},"https://studio.dronahq.com/saml/metadata"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Reply URL (Assertion Consumer Service URL)"),(0,a.kt)("td",{parentName:"tr",align:null},"It is the location where SAML assertion is sent with an ",(0,a.kt)("inlineCode",{parentName:"td"},"HTTP POST"),", known as ",(0,a.kt)("inlineCode",{parentName:"td"},"SAML Assertion Consumer Service URL"),". Locate this in the Metadata downloaded and paste it here. Ex - ",(0,a.kt)("a",{parentName:"td",href:"https://studio.dronahq.com/callback/saml"},"https://studio.dronahq.com/callback/saml"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Sign on URL"),(0,a.kt)("td",{parentName:"tr",align:null},"Use the Same as Assertion Consumer Service URL added above. Ex - ",(0,a.kt)("a",{parentName:"td",href:"https://studio.dronahq.com/callback/saml"},"https://studio.dronahq.com/callback/saml"))))),(0,a.kt)("p",null,"Set the following attributes and claims."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Setting"),(0,a.kt)("th",{parentName:"tr",align:null},"Value"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Unique User Identifier (Name ID)"),(0,a.kt)("td",{parentName:"tr",align:null},"user.mail")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"firstName"),(0,a.kt)("td",{parentName:"tr",align:null},"user.givenname")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"email"),(0,a.kt)("td",{parentName:"tr",align:null},"user.userprincipalname")))),(0,a.kt)("p",null,"You must also edit each claim and clear the value for the ",(0,a.kt)("inlineCode",{parentName:"p"},"Namespace")," field."),(0,a.kt)("h2",{id:"configure-in-dronahq"},"Configure in DronaHQ"),(0,a.kt)("p",null,"In order to configure SAML in DronaHQ, we will need metadata file of Azure. To get this file from Azure, on the same page you configured SAML settings in the ",(0,a.kt)("inlineCode",{parentName:"p"},"Microsoft Entra ID admin center"),", download the ",(0,a.kt)("inlineCode",{parentName:"p"},"Federation Metadata")," XML file (listed under the SAML Signing Certificate)."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Now that we have metadata file, In DronaHQ, Go to ",(0,a.kt)("inlineCode",{parentName:"li"},"Manage Users -> SSO Configuration -> + ADD SSO -> SAML 2.0"))),(0,a.kt)("p",null,"Enter form with below fields -"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Field"),(0,a.kt)("th",{parentName:"tr",align:null},"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Name"),(0,a.kt)("td",{parentName:"tr",align:null},"Provide Friendly Name of this SSO configuration")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Entity ID"),(0,a.kt)("td",{parentName:"tr",align:null},"The entity ID is present in Azure metadata file. Copy the ID and paste it.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Login URL / SSO URL"),(0,a.kt)("td",{parentName:"tr",align:null},"Enter the details of location of ",(0,a.kt)("inlineCode",{parentName:"td"},"AssertionConsumerService")," from Azure metadata file for POST method.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"X509 public certificate"),(0,a.kt)("td",{parentName:"tr",align:null},"X509Certificate file in ",(0,a.kt)("inlineCode",{parentName:"td"},".cer")," format. This file you can create following this ",(0,a.kt)("a",{parentName:"td",href:"/sso/configuring-sso-with-saml#creating-x509-public-certificate"},"step")," whose content you can locate in the Azure metadata file.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Binding type"),(0,a.kt)("td",{parentName:"tr",align:null},"Enter ",(0,a.kt)("inlineCode",{parentName:"td"},"HTTP POST"),".")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Restricted Domain"),(0,a.kt)("td",{parentName:"tr",align:null},"Enter domain name for which you want your users to login with for this SSO Configuration. You can add multiple domain names as well. eg - ",(0,a.kt)("inlineCode",{parentName:"td"},"domain1.com , domain2.com"),". DronaHQ will automatically redirect to SSO url when we encounter any user\u2019s sign in request with an email id belonging to the given restricted domain.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Want Auth request signed"),(0,a.kt)("td",{parentName:"tr",align:null},"Keep this default setting as ",(0,a.kt)("inlineCode",{parentName:"td"},"False"),".")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Add Claim List"),(0,a.kt)("td",{parentName:"tr",align:null},"We have already assigned Email and Name on Azure while integrating SAML. We will now enter same key name - ",(0,a.kt)("inlineCode",{parentName:"td"},"email")," and ",(0,a.kt)("inlineCode",{parentName:"td"},"name")," and map it to ",(0,a.kt)("inlineCode",{parentName:"td"},"DHQ User Name")," and ",(0,a.kt)("inlineCode",{parentName:"td"},"DHQ User Email")," respectively.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Enable JIT user provisioning"),(0,a.kt)("td",{parentName:"tr",align:null},"Toggle this ",(0,a.kt)("inlineCode",{parentName:"td"},"ON")," so that you won\u2019t have to manually invite each user to DronaHQ first.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Enable SCIM User Provisioning"),(0,a.kt)("td",{parentName:"tr",align:null},"Enable this in case you want to create, update and deactivate User accounts at your Azure portal and sync it with DronaHQ user management.")))),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Save the draft. Again navigate back to the SSO configuration option. You can see the newly created SAML.")),(0,a.kt)("figure",null,(0,a.kt)(i.Z,{src:"/img/sso/guides/sso-dronahq-okta-saml-draft.png",alt:"SAML in Draft state",mdxType:"Thumbnail"}),(0,a.kt)("figcaption",{align:"center"},(0,a.kt)("i",null,"SAML in Draft state"))),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"You can click on ",(0,a.kt)("inlineCode",{parentName:"p"},"Test SSO")," button and it will open SSO Login url in a popup window.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Once you login successfully and if everything is set up correctly, then finally you will see a success message at the bottom."))),(0,a.kt)("figure",null,(0,a.kt)(i.Z,{src:"/img/sso/guides/sso-dronahq-okta-oauth-success.png",alt:"SAML Signin Success",mdxType:"Thumbnail"}),(0,a.kt)("figcaption",{align:"center"},(0,a.kt)("i",null,"SAML Signin Success"))),(0,a.kt)("ol",{start:5},(0,a.kt)("li",{parentName:"ol"},"Now, that testing is successful, you can click on the more option for above SSO configuration and click on ",(0,a.kt)("inlineCode",{parentName:"li"},"Activate")," to make it live.")),(0,a.kt)("figure",null,(0,a.kt)(i.Z,{src:"/img/sso/guides/sso-dronahq-okta-saml-active.png",alt:"SAML SSO Active",mdxType:"Thumbnail"}),(0,a.kt)("figcaption",{align:"center"},(0,a.kt)("i",null,"SAML SSO Active"))),(0,a.kt)("h2",{id:"microsoft-entra-id-saml-in-action"},"Microsoft Entra ID SAML in Action"),(0,a.kt)("p",null,"Now, since our Microsoft Entra ID SAML SSO is live, we check in either DronaHQ End user portal - ",(0,a.kt)("a",{parentName:"p",href:"https://web.dronahq.io"},"Web"),", ",(0,a.kt)("a",{parentName:"p",href:"https://play.google.com/store/apps/details?id=com.drona5"},"Android")," or ",(0,a.kt)("a",{parentName:"p",href:"https://apps.apple.com/us/app/dronahq/id905354460"},"iOS")," and see our configured okta saml sso in action."),(0,a.kt)("p",null,"Simply go to DronaHQ End user webapp and enter your email id with domain that matches the configured restricted domain specified in SSO configuration and Click ",(0,a.kt)("inlineCode",{parentName:"p"},"Continue"),"."),(0,a.kt)("figure",null,(0,a.kt)(i.Z,{src:"/img/sso/guides/sso-dronahq-okta-saml-webapp.png",alt:"SAML in WebApp",mdxType:"Thumbnail"}),(0,a.kt)("figcaption",{align:"center"},(0,a.kt)("i",null,"SAML in WebApp"))),(0,a.kt)("p",null,"Instead of asking for password, it asks for Login via Microsoft Entra ID SAML SSO provider. Click on it to open a popup window for the user to login with Microsoft Entra ID login credentials."),(0,a.kt)("p",null,"Go to ",(0,a.kt)("inlineCode",{parentName:"p"},"Manage User")," section on DronaHQ and you will see the new user created since ",(0,a.kt)("inlineCode",{parentName:"p"},"JIT")," was enabled."))}k.isMDXComponent=!0}}]);