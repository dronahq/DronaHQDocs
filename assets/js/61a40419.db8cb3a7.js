"use strict";(self.webpackChunkdronahq_docs=self.webpackChunkdronahq_docs||[]).push([[99700],{61010:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>u,contentTitle:()=>p,default:()=>y,frontMatter:()=>l,metadata:()=>d,toc:()=>c});a(67294);var n=a(3905),r=a(86291);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})),e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}const l={sidebar_position:1},p="Prepared statements",d={unversionedId:"datasource-concepts/prepared-statements",id:"datasource-concepts/prepared-statements",title:"Prepared statements",description:"A Prepared Statement is a feature provided by Database Management Systems (DBMS), to efficiently execute the same statement with dynamic data bindings. It utilizes pre-compiled SQL code without data, resulting in faster execution.",source:"@site/docs/datasource-concepts/prepared-statements.md",sourceDirName:"datasource-concepts",slug:"/datasource-concepts/prepared-statements",permalink:"/datasource-concepts/prepared-statements",draft:!1,tags:[],version:"current",lastUpdatedAt:1692255300,formattedLastUpdatedAt:"Aug 17, 2023",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"docSidebar",previous:{title:"Migrating Connector between accounts",permalink:"/datasource-concepts/migrating-between-accounts"},next:{title:"Secrets Manager",permalink:"/datasource-concepts/secrets_manager"}},u={},c=[{value:"Why should you use prepared statements?",id:"why-should-you-use-prepared-statements",level:2},{value:"Efficiency",id:"efficiency",level:3},{value:"Security",id:"security",level:3},{value:"Prepared statement in DronaHQ",id:"prepared-statement-in-dronahq",level:2},{value:"Prepared statement support",id:"prepared-statement-support",level:3},{value:"Enable prepared statement",id:"enable-prepared-statement",level:3},{value:"When to use prepared statements in DronaHQ",id:"when-to-use-prepared-statements-in-dronahq",level:3},{value:"Simple prepared statement",id:"simple-prepared-statement",level:4},{value:"In Clause",id:"in-clause",level:4},{value:"When not to use prepared statements in DronaHQ",id:"when-not-to-use-prepared-statements-in-dronahq",level:3},{value:"Dynamic Table Name",id:"dynamic-table-name",level:4},{value:"Dynamic Queries",id:"dynamic-queries",level:4},{value:"Dynamic WHERE Clause",id:"dynamic-where-clause",level:4},{value:"Dynamic Array length",id:"dynamic-array-length",level:4},{value:"Conclusion",id:"conclusion",level:2}],m={toc:c},h="wrapper";function y(e){var{components:t}=e,a=o(e,["components"]);return(0,n.kt)(h,s(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),n.forEach((function(t){i(e,t,a[t])}))}return e}({},m,a),{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"prepared-statements"},"Prepared statements"),(0,n.kt)("p",null,"A ",(0,n.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Prepared_statement"},"Prepared Statement")," is a feature provided by Database Management Systems (DBMS), to efficiently execute the same statement with dynamic data bindings. It utilizes pre-compiled SQL code without data, resulting in faster execution."),(0,n.kt)("p",null,"In this guide, you will discover how to utilize prepared statements in DronaHQ, along with various examples for different data sources. Additionally, you will learn when to use prepared statements and when they may not be necessary."),(0,n.kt)("h2",{id:"why-should-you-use-prepared-statements"},"Why should you use prepared statements?"),(0,n.kt)("p",null,"Advantages of using prepared statements are:"),(0,n.kt)("h3",{id:"efficiency"},"Efficiency"),(0,n.kt)("p",null,"Prepared statements utilize pre-compiled SQL code, eliminating the need for compilation during each execution. This significantly speeds up execution, resulting in improved efficiency."),(0,n.kt)("h3",{id:"security"},"Security"),(0,n.kt)("p",null,"Prepared statements are parameterized and reusable blocks of code. They enforce separating the SQL command from user input data. The data bindings defined in prepared statements are sent to the server to execute the pre-compiled code block and generate the response. This approach provides a secure environment and helps prevent ",(0,n.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/SQL_injection"},"SQL injection"),", which is a prevalent web hacking technique."),(0,n.kt)("h2",{id:"prepared-statement-in-dronahq"},"Prepared statement in DronaHQ"),(0,n.kt)("p",null,"In DronaHQ, prepared statements are supported by converting user queries into parameterized queries by replacing the bindings. When creating a query with dynamic parameters with values corresponding to control/variable in an App, DronaHQ internally replaces these dynamic bindings with question marks ('?') to create Prepared Statements."),(0,n.kt)("p",null,"For instance, consider the following query created in DronaHQ:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT * FROM customers WHERE id = {{Tablegrid1.userId}};\n")),(0,n.kt)("p",null,"DronaHQ internally replaces {{Tablegrid1.userId}} with a question mark (?). The payload inserts parameters one by one, ensuring that the bindings are properly escaped and sanitized before sending the query to the database for execution. This process effectively translates an DronaHQ query into a prepared statement."),(0,n.kt)("admonition",{title:"NOTE",type:"info"},(0,n.kt)("ul",{parentName:"admonition"},(0,n.kt)("li",{parentName:"ul"},"DronaHQ takes the necessary precautions to sanitize each input, providing protection against SQL injection for the applications you build on the platform."),(0,n.kt)("li",{parentName:"ul"},"Prepared statements are not formed when creating query in the query editor, since the query editor is visible to only the admin users, but it will create prepared statements when the query is run in the app."))),(0,n.kt)("p",null,"As an example, let's consider a query with multiple bindings:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT * FROM customers WHERE id = {{Tablegrid1.userId}} AND name = {{Tablegrid1.name}};\n")),(0,n.kt)("p",null,"In this query, the first binding for ",(0,n.kt)("inlineCode",{parentName:"p"},"Id ({{Tablegrid1.userId}})")," is set as the first parameter, while the second binding for ",(0,n.kt)("inlineCode",{parentName:"p"},"name ({{Tablegrid1.name}})")," is assigned as the second parameter."),(0,n.kt)("admonition",{title:"NOTE",type:"info"},(0,n.kt)("p",{parentName:"admonition"},"The DronaHQ queries with multiple bindings are translated into the number of parameters that are supplied to a prepared statement.")),(0,n.kt)("h3",{id:"prepared-statement-support"},"Prepared statement support"),(0,n.kt)("p",null,"Prepared statements can be utilized with the following data sources in DronaHQ:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/reference/connectors/mssql"},"MS SQL")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/reference/connectors/mysql"},"My SQL")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/reference/connectors/postgresql"},"PostgreSQL")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/reference/connectors/oracle"},"Oracle"))),(0,n.kt)("h3",{id:"enable-prepared-statement"},"Enable prepared statement"),(0,n.kt)("p",null,"To use prepared statements for a datasource, you'll have to enable the prepared statement for connector configuration."),(0,n.kt)("p",null,"Go to ",(0,n.kt)("inlineCode",{parentName:"p"},"Connectors -> + CONNECTOR -> Select Supported DB"),", in this case PostgreSQL and ",(0,n.kt)("inlineCode",{parentName:"p"},"enable")," this toggle named ",(0,n.kt)("inlineCode",{parentName:"p"},"Enable converting queries to prepared statement")," to Enable prepared statement."),(0,n.kt)(r.Z,{src:"/img/connecting-datasource/concepts/enable_prepared_statement.png",alt:"Simple Database GUI",width:"50%",mdxType:"Thumbnail"}),(0,n.kt)("p",null,"While there may be some variations in query creation syntax ",(0,n.kt)("a",{parentName:"p",href:"#prepared-statement-support"},"among the mentioned data sources"),", the capability to enable or disable prepared statements is available for virtually every scenario, as exemplified below."),(0,n.kt)("h3",{id:"when-to-use-prepared-statements-in-dronahq"},"When to use prepared statements in DronaHQ"),(0,n.kt)("p",null,"DronaHQ provides support for utilizing prepared statements, allowing dynamic data bindings in the WHERE clause. It's important to keep the query preceding the WHERE clause static and specify the column names used for data filtering. However, the actual data can be dynamically set based on user input."),(0,n.kt)("p",null,"In the code snippet below, you can observe the dynamic addition of data bindings enclosed within ",(0,n.kt)("inlineCode",{parentName:"p"},"double curly braces {{}}"),", representing user input:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT * FROM Customers WHERE ID = {{Tablegrid1.Id}}\n")),(0,n.kt)("admonition",{title:"NOTE",type:"info"},(0,n.kt)("p",{parentName:"admonition"},"Prepared statements in DronaHQ only allow bindings for data supplied to columns within the WHERE clause.")),(0,n.kt)("p",null,"Here are some examples showcasing when and how you can effectively utilize prepared statements:"),(0,n.kt)("h4",{id:"simple-prepared-statement"},"Simple prepared statement"),(0,n.kt)("p",null,"Prepared statements are suitable for performing Create, Read, Update, or Delete (CRUD) operations, enabling manipulation of database table data with dynamic data bindings. For instance, when capturing customer registration details from a registration form in DronaHQ, you can use a simple insert query with prepared statements:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sql"},"Insert into customers (name, email) values ({{username}}, {{useremail}});\n")),(0,n.kt)("p",null,"In this example, ",(0,n.kt)("inlineCode",{parentName:"p"},"username")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"useremail")," are the two text input controls of the registration form."),(0,n.kt)("h4",{id:"in-clause"},"In Clause"),(0,n.kt)("p",null,"When implementing a search feature where customers can select different statuses to filter results, you can use the IN clause. You have two scenarios for IN clause queries: dynamic array length and static array length. Its supported for Static array length."),(0,n.kt)("p",null,"Static Array Length:\nWhen you know the exact number of data bindings for the IN clause, you can specify them directly. For example:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT * from customers where type in ({{subscriptionOption}} , {{status}})\n")),(0,n.kt)("p",null,"Here, ",(0,n.kt)("inlineCode",{parentName:"p"},"subscriptionOption")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"status")," are two different dropdown control that are added in the ",(0,n.kt)("inlineCode",{parentName:"p"},"in clause"),"."),(0,n.kt)("h3",{id:"when-not-to-use-prepared-statements-in-dronahq"},"When not to use prepared statements in DronaHQ"),(0,n.kt)("p",null,"There are certain scenarios where using prepared statements is not suitable:"),(0,n.kt)("h4",{id:"dynamic-table-name"},"Dynamic Table Name"),(0,n.kt)("p",null,"If you dynamically generate a table name based on certain criteria in your code logic and supply it as a binding to the query, prepared statements will not work. For instance:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sql"},"Select * from {{Runtime_Generated_Table_Name}}\n")),(0,n.kt)("h4",{id:"dynamic-queries"},"Dynamic Queries"),(0,n.kt)("p",null,"When you generate a query on the fly based on parameters and execute it, the prepared statements will not function properly. For example:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sql"},"select * from {{Query_to_Execute.text}}\n")),(0,n.kt)("h4",{id:"dynamic-where-clause"},"Dynamic WHERE Clause"),(0,n.kt)("p",null,"If you generate a WHERE clause based on code logic, dynamically adding columns and data based on user input, prepared statements will not be able to execute properly. An example is:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT * FROM customers WHERE {{DynamicWhereClause}}\n")),(0,n.kt)("h4",{id:"dynamic-array-length"},"Dynamic Array length"),(0,n.kt)("p",null,"When the selected options can vary, and the array length is dynamic, you can generate a dynamic IN clause with indefinite bindings. In this case prepared statements will not be able to execute properly. For example:"),(0,n.kt)("p",null,"SELECT * from users where status in = ANY ({{selectedOptionValues}})"),(0,n.kt)("p",null,"For such scenarios, it is recommended to disable prepared statements and continue using the query for generating responses."),(0,n.kt)("admonition",{title:"NOTE",type:"info"},(0,n.kt)("p",{parentName:"admonition"},"Prepared statements require a static part of the query to understand the type of operation (Create, Read, Update, or Delete) performed on the database table, as well as the columns used in the WHERE clause for data filtering.")),(0,n.kt)("h2",{id:"conclusion"},"Conclusion"),(0,n.kt)("p",null,"Prepared statements enhance ",(0,n.kt)("a",{parentName:"p",href:"#efficiency"},"efficiency")," and ",(0,n.kt)("a",{parentName:"p",href:"#security"},"security")," in data manipulation for apps developed on DronaHQ. With built-in sanitization provided by DronaHQ, you can seamlessly build complex applications that meet your requirements."))}y.isMDXComponent=!0}}]);