"use strict";(self.webpackChunkdronahq_docs=self.webpackChunkdronahq_docs||[]).push([[75485],{25009:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>d,default:()=>k,frontMatter:()=>s,metadata:()=>c,toc:()=>p});n(67294);var i=n(3905),a=n(86291);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function l(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}const s={sidebar_position:1,title:"REST API Security with JWT Token Authentication"},d=void 0,c={unversionedId:"building-apps-guides/rest-api-jwt-auth",id:"building-apps-guides/rest-api-jwt-auth",title:"REST API Security with JWT Token Authentication",description:"We are already aware of using the REST API with different authentication methods like OAuth 2.0, API keys, and so on. In this article, we are going to discuss JWT Token Authentication, wherein we will create a JWT Token inside the DronaHQ using JS Code Block, and using this generated token, access resources from a REST API.",source:"@site/docs/building-apps-guides/rest-api-jwt-auth.md",sourceDirName:"building-apps-guides",slug:"/building-apps-guides/rest-api-jwt-auth",permalink:"/building-apps-guides/rest-api-jwt-auth",draft:!1,tags:[],version:"current",lastUpdatedAt:1724759326,formattedLastUpdatedAt:"Aug 27, 2024",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"REST API Security with JWT Token Authentication"},sidebar:"docSidebar",previous:{title:"Repeatable forms",permalink:"/building-apps-guides/repeatable-forms"},next:{title:"Google Sheet - Multiple Row update",permalink:"/building-apps-guides/update-multiplerows-google-sheet"}},u={},p=[{value:"Quick Setup for the REST API Connector",id:"quick-setup-for-the-rest-api-connector",level:2},{value:"App Building with Table Grid Control",id:"app-building-with-table-grid-control",level:2},{value:"Code",id:"code",level:4},{value:"Code Explanation",id:"code-explanation",level:4}],h={toc:p},g="wrapper";function k(e){var{components:t}=e,n=l(e,["components"]);return(0,i.kt)(g,o(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){r(e,t,n[t])}))}return e}({},h,n),{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"We are already aware of using the REST API with different authentication methods like OAuth 2.0, API keys, and so on. In this article, we are going to discuss JWT Token Authentication, wherein we will create a JWT Token inside the DronaHQ using JS Code Block, and using this generated token, access resources from a REST API."),(0,i.kt)("h2",{id:"quick-setup-for-the-rest-api-connector"},"Quick Setup for the REST API Connector"),(0,i.kt)("p",null,"Add a REST Api connector which will get the JWT token."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Authentication: Set it to None."),(0,i.kt)("li",{parentName:"ul"},"Authorization Header: Add a new header named Authorization that will hold your JWT Token.")),(0,i.kt)("h2",{id:"app-building-with-table-grid-control"},"App Building with Table Grid Control"),(0,i.kt)("p",null,"In this example, we'll be using the Screen Open Action to kick things off and grab data from a REST API. To show the information we pull in, we'll be using a handy tool called the Table Grid Control. "),(0,i.kt)("p",null,"First up, we'll need to create a JS Code Block. This is where we'll write the magic code to create a JWT token."),(0,i.kt)("h4",{id:"code"},"Code"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'function base64url(source) \n{\n    encodedSource = CryptoJS.enc.Base64.stringify(source);\n    encodedSource = encodedSource.replace(/=+$/, \'\');\n    encodedSource = encodedSource.replace(/\\+/g, \'-\');\n    encodedSource = encodedSource.replace(/\\//g, \'_\');\n    return encodedSource;\n}\nfunction createJWT(header, data, secret = undefined) {\n    let stringifiedHeader = CryptoJS.enc.Utf8.parse(JSON.stringify(header));\n    let encodedHeader = base64url(stringifiedHeader);\n    let stringifiedData = CryptoJS.enc.Utf8.parse(JSON.stringify(data));\n    let encodedData = base64url(stringifiedData);\n    let token = encodedHeader + "." + encodedData;\n    if (!secret) return token;\n    let signature = CryptoJS.HmacSHA256(token, secret);\n    signature = base64url(signature);\n    return encodedHeader + "." + encodedData + "." + signature;\n}\n\nconst header = {\n"alg": "HS256",\n"typ": "JWT"\n};\nconst data = {\n    "email": "john@example.com",\n    "password": "@johncarter"\n};\nconst secret = "john@99";\n\nconst token = createJWT(header, data, secret);\noutput = `Bearer ${token}`;\n')),(0,i.kt)("h4",{id:"code-explanation"},"Code Explanation"),(0,i.kt)("p",null,"Let's break down the process:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Base64 Encoding Function: The ",(0,i.kt)("inlineCode",{parentName:"p"},"base64url")," function encodes a source string into a URL-safe Base64 format. It replaces specific characters to ensure compatibility with URLs.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"JWT Token Creation Function: The ",(0,i.kt)("inlineCode",{parentName:"p"},"createJWT")," function generates a JWT token. It first converts the header and data objects into UTF-8 encoded strings, then encodes them into URL-safe Base64 format. The token is formed by concatenating the encoded header and data strings with a period. If a secret key is provided, the token is signed using HMAC SHA-256, and the signature is appended to the token.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Header and Data Objects: The ",(0,i.kt)("inlineCode",{parentName:"p"},"header")," object specifies the algorithm (HS256) and token type (JWT). The ",(0,i.kt)("inlineCode",{parentName:"p"},"data")," object contains user-specific information such as email and password.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Secret Key: The ",(0,i.kt)("inlineCode",{parentName:"p"},"secret")," variable holds the secret key used for signing the JWT token, providing an additional layer of security.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Final Output: The generated JWT token is stored in the ",(0,i.kt)("inlineCode",{parentName:"p"},"token")," variable. It is prefixed with 'Bearer' to form the final output, which can be used for authentication purposes."))),(0,i.kt)("figure",null,(0,i.kt)(a.Z,{src:"/img/building-apps-guides/rest-api-jwt/rest-api-jwt-code.png",alt:"JS Code",mdxType:"Thumbnail"}),(0,i.kt)("figcaption",{align:"center"},(0,i.kt)("i",null,"JS Code"))),(0,i.kt)("p",null,"Capture the output of the JS Code Block by saving the task, to pass it to the REST API Connector."),(0,i.kt)("p",null,"Now add the REST API Connector we created earlier, and in the field of Authorization select the JS Code Block output."),(0,i.kt)("figure",null,(0,i.kt)(a.Z,{src:"/img/building-apps-guides/rest-api-jwt/rest-api-jwt.png",alt:"JS Code",mdxType:"Thumbnail"})),(0,i.kt)("p",null,"Save the query, this will hold the response sent by the REST API, in our case the query name is ",(0,i.kt)("inlineCode",{parentName:"p"},"GetUsersData"),"."),(0,i.kt)("p",null,"The final step involves integrating the response data from the REST API with the TableGrid Control. "),(0,i.kt)("p",null,"Add the ",(0,i.kt)("inlineCode",{parentName:"p"},"Set Control Value Action")," to the success branch of the REST API connector. This action will handle the assignment of data to the TableGrid Control."),(0,i.kt)("figure",null,(0,i.kt)(a.Z,{src:"/img/building-apps-guides/rest-api-jwt/rest-api-jwt-flow.png",alt:"Set Control Value Action",mdxType:"Thumbnail"}),(0,i.kt)("figcaption",{align:"center"},(0,i.kt)("i",null,"Set Control Value Action"))),(0,i.kt)("p",null,"After configuring the action, execute the application."),(0,i.kt)("p",null,"Upon running the application, you'll observe that the data retrieved from the API is populated onto the TableGrid Control."))}k.isMDXComponent=!0}}]);