"use strict";(self.webpackChunkdronahq_docs=self.webpackChunkdronahq_docs||[]).push([[3384],{43982:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>s,default:()=>g,frontMatter:()=>p,metadata:()=>d,toc:()=>c});n(67294);var i=n(3905),a=n(86291);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function l(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}const p={sidebar_position:1},s="Configure Microsoft Entra ID OIDC",d={unversionedId:"sso-guides/configure-microsoft-entra-oidc",id:"sso-guides/configure-microsoft-entra-oidc",title:"Configure Microsoft Entra ID OIDC",description:"Use this guide to configure Microsoft Entra ID SSO with OpenID Connect (OIDC) on DronaHQ. Once configured, users can log in to DronaHQ with their Microsoft Entra ID credentials.",source:"@site/docs/sso-guides/configure-microsoft-entra-oidc.md",sourceDirName:"sso-guides",slug:"/sso-guides/configure-microsoft-entra-oidc",permalink:"/sso-guides/configure-microsoft-entra-oidc",draft:!1,tags:[],version:"current",lastUpdatedAt:1723467393,formattedLastUpdatedAt:"Aug 12, 2024",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"docSidebar",previous:{title:"Configure Auth0 OIDC SSO",permalink:"/sso-guides/configure-auth0-oidc"},next:{title:"Configure Microsoft Entra ID SAML",permalink:"/sso-guides/configure-microsoft-entra-saml"}},u={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Setting up Microsoft Entra ID",id:"setting-up-microsoft-entra-id",level:2},{value:"Configure secrets",id:"configure-secrets",level:2},{value:"Configure claims",id:"configure-claims",level:2},{value:"Configure optional group claims",id:"configure-optional-group-claims",level:2},{value:"Locate connection details",id:"locate-connection-details",level:2},{value:"Configure in DronaHQ",id:"configure-in-dronahq",level:2},{value:"Steps",id:"steps",level:3}],m={toc:c},k="wrapper";function g(e){var{components:t}=e,n=l(e,["components"]);return(0,i.kt)(k,r(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){o(e,t,n[t])}))}return e}({},m,n),{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"configure-microsoft-entra-id-oidc"},"Configure Microsoft Entra ID OIDC"),(0,i.kt)("p",null,"Use this guide to configure Microsoft Entra ID SSO with OpenID Connect (OIDC) on DronaHQ. Once configured, users can log in to DronaHQ with their Microsoft Entra ID credentials."),(0,i.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,i.kt)("p",null,"To set up Microsoft Entra ID OIDC in DronaHQ, you will need:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Permissions to create an Microsoft Entra ID Enterprise application."),(0,i.kt)("li",{parentName:"ol"},"Manage Users access on self-hosted DronaHQ instance or DronaHQ Cloud to configure SSO configurations.")),(0,i.kt)("h2",{id:"setting-up-microsoft-entra-id"},"Setting up Microsoft Entra ID"),(0,i.kt)("p",null,"To create an Microsoft Entra ID Enterprise application, follow the steps in ",(0,i.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/azure/active-directory/manage-apps/add-application-portal-setup-oidc-sso"},"this documentation"),"."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the ",(0,i.kt)("inlineCode",{parentName:"p"},"Microsoft Entra ID portal"),", add a new ",(0,i.kt)("inlineCode",{parentName:"p"},"Enterprise application"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"DronaHQ is not listed in the Microsoft Entra ID Gallery, so select ",(0,i.kt)("inlineCode",{parentName:"p"},"Create your own application"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Give User friendly Name for the application to identify SSO for DronaHQ.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("inlineCode",{parentName:"p"},"Register an application to integrate with Microsoft Entra ID (App you're developing)"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Under ",(0,i.kt)("inlineCode",{parentName:"p"},"Supported account types"),", select ",(0,i.kt)("inlineCode",{parentName:"p"},"Accounts in this organizational directory only (Default Directory Only - Single tenant)"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Under ",(0,i.kt)("inlineCode",{parentName:"p"},"Redirect URI"),", select ",(0,i.kt)("inlineCode",{parentName:"p"},"Web"),". Enter ",(0,i.kt)("inlineCode",{parentName:"p"},"DronaHQ Redirect URL")," under the path. This specifies the path where Microsoft Entra ID redirects users after they complete authentication. You can locate it on DronaHQ portal, Go to ",(0,i.kt)("inlineCode",{parentName:"p"},"Manage Users -> SSO CONFIGURATION -> + Add SSO -> OIDC OpenID Connect")," and Copy DronaHQ OAuth Redirect URL and paste it in Redirect URIs path field above."),(0,i.kt)("figure",null,(0,i.kt)(a.Z,{src:"/img/sso/sso-oauth-redirect.png",alt:"DronaHQ OAuth Redirect URL",mdxType:"Thumbnail"}),(0,i.kt)("figcaption",{align:"center"},(0,i.kt)("i",null,"DronaHQ OAuth Redirect URL"))))),(0,i.kt)("h2",{id:"configure-secrets"},"Configure secrets"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the settings for the new DronaHQ enterprise application, select the ",(0,i.kt)("inlineCode",{parentName:"p"},"Single sign-on")," menu. Select the ",(0,i.kt)("inlineCode",{parentName:"p"},"App registrations experience"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the ",(0,i.kt)("inlineCode",{parentName:"p"},"Certifications & secrets")," menu. Add a new client secret and set an expiration period. You must update your DronaHQ SSO configuration when the secret expires, so you should set the maximum allowable period to ",(0,i.kt)("inlineCode",{parentName:"p"},"24 months"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Save this secret for use in a later step."))),(0,i.kt)("h2",{id:"configure-claims"},"Configure claims"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the ",(0,i.kt)("inlineCode",{parentName:"p"},"Azure app registration experience"),", select the ",(0,i.kt)("inlineCode",{parentName:"p"},"Token configuration")," menu.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("inlineCode",{parentName:"p"},"Add optional claim")," for the ",(0,i.kt)("inlineCode",{parentName:"p"},"ID token"),". Add the following claims:"))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"acct"),(0,i.kt)("li",{parentName:"ul"},"email"),(0,i.kt)("li",{parentName:"ul"},"given_name")),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"When you save the claims, ",(0,i.kt)("inlineCode",{parentName:"p"},"turn on the Microsoft Graph email, profile permissions"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Optionally, specify additional claims to include for the ",(0,i.kt)("inlineCode",{parentName:"p"},"Access token"),"."))),(0,i.kt)("h2",{id:"configure-optional-group-claims"},"Configure optional group claims"),(0,i.kt)("p",null,"You can optionally map Microsoft Entra ID groups to DronaHQ groups to automatically assign users to groups when they authenticate using SSO. This requires adding group claims to the ",(0,i.kt)("inlineCode",{parentName:"p"},"ID token"),"."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the ",(0,i.kt)("inlineCode",{parentName:"p"},"Azure app registration experience"),", select the ",(0,i.kt)("inlineCode",{parentName:"p"},"Token configuration")," menu.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select ",(0,i.kt)("inlineCode",{parentName:"p"},"Add optional claim")," for the ",(0,i.kt)("inlineCode",{parentName:"p"},"ID token"),"."))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"In the claim, include the groups you want to map to DronaHQ groups."),(0,i.kt)("li",{parentName:"ul"},"Include the ",(0,i.kt)("inlineCode",{parentName:"li"},"Group ID")," for ",(0,i.kt)("inlineCode",{parentName:"li"},"ID"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"Access"),", and ",(0,i.kt)("inlineCode",{parentName:"li"},"SAML"),".")),(0,i.kt)("h2",{id:"locate-connection-details"},"Locate connection details"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In the ",(0,i.kt)("inlineCode",{parentName:"p"},"Azure app registration experience"),", select the ",(0,i.kt)("inlineCode",{parentName:"p"},"Overview")," menu and select ",(0,i.kt)("inlineCode",{parentName:"p"},"Endpoints"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Save the following fields to use in DronaHQ:"))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Application (client) ID"),(0,i.kt)("li",{parentName:"ul"},"OAuth 2.0 authorization endpoint (v2)"),(0,i.kt)("li",{parentName:"ul"},"OAuth 2.0 token endpoint (v2)")),(0,i.kt)("h2",{id:"configure-in-dronahq"},"Configure in DronaHQ"),(0,i.kt)("p",null,"For setting up OIDC SSO in DronaHQ, Go to ",(0,i.kt)("inlineCode",{parentName:"p"},"Manage Users -> SSO CONFIGURATION -> + Add SSO -> OIDC OpenID Connect")),(0,i.kt)("p",null,"Enter form with below fields -"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Field"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Name"),(0,i.kt)("td",{parentName:"tr",align:null},"Provide Friendly Name of this SSO configuration")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Restricted Domain"),(0,i.kt)("td",{parentName:"tr",align:null},"Enter domain name for which you want your users to login with for this SSO Configuration. You can add multiple domain names as well. eg - ",(0,i.kt)("inlineCode",{parentName:"td"},"domain1.com , domain2.com"),". DronaHQ will automatically redirect to SSO url when we encounter any user\u2019s sign in request with an email id belonging to the given restricted domain.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null}),(0,i.kt)("td",{parentName:"tr",align:null})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Client ID"),(0,i.kt)("td",{parentName:"tr",align:null},"Client ID from your OAuth app created above.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Client Secret"),(0,i.kt)("td",{parentName:"tr",align:null},"Client Secret from your OAuth app created above.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Scope"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"openid profile email offline_access"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Authorization Request"),(0,i.kt)("td",{parentName:"tr",align:null},"Authorization endpoint provided by Microsoft located from above steps i.e. ",(0,i.kt)("inlineCode",{parentName:"td"},"https://login.microsoftonline.com/<issuer>/oauth2/v2.0/authorize")," where ",(0,i.kt)("inlineCode",{parentName:"td"},"<issuer>")," is your account id provided by Microsoft.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Access Token Request"),(0,i.kt)("td",{parentName:"tr",align:null},"Token endpoint provided by Microsoft located from above steps i.e. ",(0,i.kt)("inlineCode",{parentName:"td"},"https://login.microsoftonline.com/<issuer>/oauth2/v2.0/token")," where ",(0,i.kt)("inlineCode",{parentName:"td"},"<issuer>")," is your account id provided by Microsoft.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Refresh Token Request"),(0,i.kt)("td",{parentName:"tr",align:null},"Token endpoint provided by Microsoft located from above steps i.e. ",(0,i.kt)("inlineCode",{parentName:"td"},"https://login.microsoftonline.com/<issuer>/oauth2/v2.0/token")," where ",(0,i.kt)("inlineCode",{parentName:"td"},"<issuer>")," is your account id provided by Microsoft. This will be called, when using current access token returns ",(0,i.kt)("inlineCode",{parentName:"td"},"401 status code")," response")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Add Claim List"),(0,i.kt)("td",{parentName:"tr",align:null},"You can map your ",(0,i.kt)("inlineCode",{parentName:"td"},"User's ID, Name, Email and Group")," with corresponding values in DronaHQ. Here, you need to provide exact path of corresponding key present in JWT Token received from Token endpoint. Add ",(0,i.kt)("inlineCode",{parentName:"td"},"{{idToken.email}}")," to map against ",(0,i.kt)("inlineCode",{parentName:"td"},"DHQ User Email"),", this will refer to ",(0,i.kt)("inlineCode",{parentName:"td"},"email")," key present in ",(0,i.kt)("inlineCode",{parentName:"td"},"idToken")," parameter. Similarly you can add ",(0,i.kt)("inlineCode",{parentName:"td"},"{{idToken.given_name}}")," to map against ",(0,i.kt)("inlineCode",{parentName:"td"},"DHQ User Name"),", this will refer to ",(0,i.kt)("inlineCode",{parentName:"td"},"given_name")," key present in ",(0,i.kt)("inlineCode",{parentName:"td"},"idToken")," parameter. Similarly you can add ",(0,i.kt)("inlineCode",{parentName:"td"},"{{idToken.groups}}")," to map against ",(0,i.kt)("inlineCode",{parentName:"td"},"DHQ User Group"),", this will refer to ",(0,i.kt)("inlineCode",{parentName:"td"},"groups")," key present in ",(0,i.kt)("inlineCode",{parentName:"td"},"idToken")," parameter.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Enable JIT user provisioning"),(0,i.kt)("td",{parentName:"tr",align:null},"Just in time (JIT) user provisioning enables DronaHQ to provision user accounts when users sign in via Microsoft Entra ID SSO for the ",(0,i.kt)("inlineCode",{parentName:"td"},"first time"),". This means you won't have to manually invite each user to DronaHQ first.")))),(0,i.kt)("admonition",{title:"TIP",type:"tip"},(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"Enable JIT user provisioning toggle to automatically add new users provisioned by SSO into DronaHQ"),(0,i.kt)("li",{parentName:"ul"},"Map group name to provide restricted access of the App to the specific group of end users. For Example, you may want to restrict the Finance related Apps to your Finance team members in your organization and HR specific apps to your HR Team in your organization and so on. By default all users will be mapped to the Default group in DronaHQ."),(0,i.kt)("li",{parentName:"ul"},"If user's group is mapped with DronaHQ Group, and at time of user login, if its group name doesn't exists then DronaHQ will create a new group with same name and map it with this user."))),(0,i.kt)("h3",{id:"steps"},"Steps"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Fill above form."),(0,i.kt)("li",{parentName:"ol"},"Once, above form is filled, click on ",(0,i.kt)("inlineCode",{parentName:"li"},"Save to draft")," option to save your SSO Configuration."),(0,i.kt)("li",{parentName:"ol"},"You will be able to view your recently saved SSO configuration in the list. You can click on ",(0,i.kt)("inlineCode",{parentName:"li"},"Test SSO")," button and it will open SSO Login url in a popup. Once you login successfully and if everything is set up correctly, then finally you will see a success message at the bottom."),(0,i.kt)("li",{parentName:"ol"},"Now, that testing is successful, you can click on the ",(0,i.kt)("inlineCode",{parentName:"li"},"more option")," for above SSO configuration and click on ",(0,i.kt)("inlineCode",{parentName:"li"},"Activate")," to make it live.")),(0,i.kt)("figure",null,(0,i.kt)(a.Z,{src:"/img/sso/sso-oauth-login-activate.png",alt:"Activate SSO",mdxType:"Thumbnail"}),(0,i.kt)("figcaption",{align:"center"},(0,i.kt)("i",null,"Activate SSO"))),(0,i.kt)("p",null,"Once live, all your users belonging to above given domain will be redirected to your SSO login from both the ",(0,i.kt)("inlineCode",{parentName:"p"},"End User Portal")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"Creator Portal"),"."),(0,i.kt)("p",null,"With Microsoft Entra ID Single Sign-On (SSO), users can login into DronaHQ using a single set of login credentials. It simplifies user provisioning and management. User accounts can be created, updated, and deactivated centrally, ensuring efficient administration across all connected applications."))}g.isMDXComponent=!0}}]);