"use strict";(self.webpackChunkdronahq_docs=self.webpackChunkdronahq_docs||[]).push([[60227],{73854:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>d,default:()=>f,frontMatter:()=>l,metadata:()=>s,toc:()=>p});n(67294);var o=n(3905);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function i(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const l={sidebar_position:97},d="Configure DocumentDB",s={unversionedId:"self-hosted-deployment/configure-documentdb-storage",id:"self-hosted-deployment/configure-documentdb-storage",title:"Configure DocumentDB",description:"DronaHQ needs mongodb compatible storage to store data about apps and connectors. Using mongodb compatible storage makes it easy and faster to access all this stored data.",source:"@site/docs/self-hosted-deployment/configure-documentdb-storage.md",sourceDirName:"self-hosted-deployment",slug:"/self-hosted-deployment/configure-documentdb-storage",permalink:"/self-hosted-deployment/configure-documentdb-storage",draft:!1,tags:[],version:"current",lastUpdatedAt:1727441217,formattedLastUpdatedAt:"Sep 27, 2024",sidebarPosition:97,frontMatter:{sidebar_position:97},sidebar:"docSidebar",previous:{title:"Update DronaHQ version",permalink:"/self-hosted-deployment/update-dronahq-to-latest"},next:{title:"Configure External Databases",permalink:"/self-hosted-deployment/configure-external-databases"}},c={},p=[{value:"1. Setup DocumentDB and create credentials for DronaHQ",id:"1-setup-documentdb-and-create-credentials-for-dronahq",level:4},{value:"2. Restore required data into DocumentDB",id:"2-restore-required-data-into-documentdb",level:4},{value:"3. Copy certificate file to the host machine",id:"3-copy-certificate-file-to-the-host-machine",level:4},{value:"4. Add volume mapping",id:"4-add-volume-mapping",level:4},{value:"5. Add environment variables",id:"5-add-environment-variables",level:4},{value:"<code>MONGODB_TLS</code>",id:"mongodb_tls",level:4},{value:"<code>MONGODB_CA_CERT_DIR</code>",id:"mongodb_ca_cert_dir",level:4}],u={toc:p},m="wrapper";function f(e){var{components:t}=e,n=i(e,["components"]);return(0,o.kt)(m,a(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){r(e,t,n[t])}))}return e}({},u,n),{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"configure-documentdb"},"Configure DocumentDB"),(0,o.kt)("p",null,"DronaHQ needs mongodb compatible storage to store data about apps and connectors. Using mongodb compatible storage makes it easy and faster to access all this stored data."),(0,o.kt)("p",null,"You can use DocumentDB service from Amazon Web Service as an alternative to MongoDB."),(0,o.kt)("p",null,"Follow the steps mentioned below for configuring DocumentDB with DronaHQ:"),(0,o.kt)("h4",{id:"1-setup-documentdb-and-create-credentials-for-dronahq"},"1. Setup DocumentDB and create credentials for DronaHQ"),(0,o.kt)("p",null,"Create DocumentDB cluster using ",(0,o.kt)("inlineCode",{parentName:"p"},"AWS Management Console"),". Also, create user credentials with necessary permissions for DronaHQ using ",(0,o.kt)("inlineCode",{parentName:"p"},"MongoDb Client")),(0,o.kt)("h4",{id:"2-restore-required-data-into-documentdb"},"2. Restore required data into DocumentDB"),(0,o.kt)("p",null,"Download prerequisite data dump from DronaHQ and restore it onto DocumentDB."),(0,o.kt)("p",null,"Refer ",(0,o.kt)("a",{parentName:"p",href:"http://localhost:3000/self-hosted-deployment/configure-external-databases/"},"Configure External Databases")),(0,o.kt)("h4",{id:"3-copy-certificate-file-to-the-host-machine"},"3. Copy certificate file to the host machine"),(0,o.kt)("p",null,"Download certificate file onto host machine. You can find the download link on ",(0,o.kt)("inlineCode",{parentName:"p"},"Amazon Managment Console"),". Once you download the file, place it at your desired location."),(0,o.kt)("p",null,"Example: Move file from ",(0,o.kt)("inlineCode",{parentName:"p"},"Home")," directory to ",(0,o.kt)("inlineCode",{parentName:"p"},"/certificates")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"sudo mkdir /certificates\n\nmv ~/global.bundle.pem /certificates/global.bundle.pem\n")),(0,o.kt)("h4",{id:"4-add-volume-mapping"},"4. Add volume mapping"),(0,o.kt)("p",null,"Go to ",(0,o.kt)("inlineCode",{parentName:"p"},"DronaHQ")," installation directory and Open file ",(0,o.kt)("inlineCode",{parentName:"p"},"docker-compose.yml"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"nano docker-compose.yml\n")),(0,o.kt)("p",null,"Add volume mapping for your certificate file with ",(0,o.kt)("inlineCode",{parentName:"p"},"webapp")," service."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"services:\n\n  webapp:\n    image: dronahq/self-hosted:3.1.2-stable\n    platform: linux/amd64\n    container_name: dronahq-self-hosted-webapp\n    restart: always\n    volumes:\n      - ./dronahq.env:/app/.env:ro\n      - ./storage/files:/app/files:rw\n      - ./storage/private:/app/private:rw\n\n      - /certificates/global.bundle.pem:/private/global.bundle.pem:ro\n\n    ports:\n      - 8080:8080\n\n...\n")),(0,o.kt)("p",null,"In above example, we added mapping as ",(0,o.kt)("inlineCode",{parentName:"p"},"/certificates/global.bundle.pem:/private/global.bundle.pem:ro"),". Notice the values are present in this line separated by colon (:). First value is path of file on host machine. Second parameter is desired path of file on container. And third parameter talks about read-only directive."),(0,o.kt)("h4",{id:"5-add-environment-variables"},"5. Add environment variables"),(0,o.kt)("p",null,"Configure environment variables necessary to connect to DocumentDB. Refer ",(0,o.kt)("a",{parentName:"p",href:"http://localhost:3000/self-hosted-deployment/environment-variables/#connectivity-to-mongodb"},"Environment Variables")," for detailed information about variables to configure."),(0,o.kt)("p",null,"Following are variables needed to be configured extra for using DocumentDB"),(0,o.kt)("h4",{id:"mongodb_tls"},(0,o.kt)("inlineCode",{parentName:"h4"},"MONGODB_TLS")),(0,o.kt)("p",null,"Specifies whether TLS is required for connections to the server."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"MONGODB_TLS='true'\n")),(0,o.kt)("h4",{id:"mongodb_ca_cert_dir"},(0,o.kt)("inlineCode",{parentName:"h4"},"MONGODB_CA_CERT_DIR")),(0,o.kt)("p",null,"Specifies the path to a file with either a single or bundle of certificate authorities to trust when making a TLS connection."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"MONGODB_CA_CERT_DIR='/private/global.bundle.pem'\n")))}f.isMDXComponent=!0}}]);