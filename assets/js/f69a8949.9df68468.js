"use strict";(self.webpackChunkdronahq_docs=self.webpackChunkdronahq_docs||[]).push([[69930],{95721:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>p,default:()=>m,frontMatter:()=>l,metadata:()=>c,toc:()=>u});n(67294);var a=n(3905),i=n(86291);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const l={sidebar_position:1,title:"Convert JSON Data for GraphQL Mutations"},p=void 0,c={unversionedId:"app-scripting-and-code/json-to-graphql-mutation",id:"app-scripting-and-code/json-to-graphql-mutation",title:"Convert JSON Data for GraphQL Mutations",description:'When integrating data into your GraphQL API using mutations, the data format needs to adhere to specific requirements. Here\'s the key point: GraphQL mutations expect key names within double quotes (e.g., "name"), whereas JSON offers more flexibility and might not always include these quotes. This discrepancy necessitates a conversion step to ensure data utilization within your GraphQL environment.',source:"@site/docs/app-scripting-and-code/json-to-graphql-mutation.md",sourceDirName:"app-scripting-and-code",slug:"/app-scripting-and-code/json-to-graphql-mutation",permalink:"/app-scripting-and-code/json-to-graphql-mutation",draft:!1,tags:[],version:"current",lastUpdatedAt:1714649741,formattedLastUpdatedAt:"May 2, 2024",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"Convert JSON Data for GraphQL Mutations"},sidebar:"docSidebar",previous:{title:"JS transformation",permalink:"/app-scripting-and-code/js-transformation"},next:{title:"Display Nested JSON Data in a Tablegrid",permalink:"/app-scripting-and-code/unnest-json"}},d={},u=[{value:"The JavaScript Solution",id:"the-javascript-solution",level:2},{value:"Code",id:"code",level:4},{value:"Code Explanation",id:"code-explanation",level:4},{value:"Code",id:"code-1",level:4},{value:"Considerations",id:"considerations",level:2}],h={toc:u},g="wrapper";function m(e){var{components:t}=e,n=s(e,["components"]);return(0,a.kt)(g,o(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){r(e,t,n[t])}))}return e}({},h,n),{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"When integrating data into your GraphQL API using mutations, the data format needs to adhere to specific requirements. Here's the key point: GraphQL mutations expect key names within double quotes (e.g., ",(0,a.kt)("inlineCode",{parentName:"p"},'"name"'),"), whereas JSON offers more flexibility and might not always include these quotes. This discrepancy necessitates a conversion step to ensure data utilization within your GraphQL environment."),(0,a.kt)("h2",{id:"the-javascript-solution"},"The JavaScript Solution"),(0,a.kt)("p",null,"The following JavaScript code snippet serves as the conversion bridge, transforming your JSON data into a format suitable for GraphQL mutations:"),(0,a.kt)("h4",{id:"code"},"Code"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},'let output;\n\nif (typeof SheetData === "object") {\n  output = JSON.stringify(SheetData);\n} else if (typeof SheetData === "string") {\n  try {\n    output = JSON.stringify(JSON.parse(SheetData));\n  } catch (error) {\n    // Implement error handling (e.g., log the error)\n  }\n}\n\noutput = output.replace(/"([^"]+)":/g, \'$1:\');\n')),(0,a.kt)("h4",{id:"code-explanation"},"Code Explanation"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Type Check: The code first verifies the data type of ",(0,a.kt)("inlineCode",{parentName:"li"},"SheetData"),". If it's already an object, ",(0,a.kt)("inlineCode",{parentName:"li"},"JSON.stringify")," promptly converts it to a string representation."),(0,a.kt)("li",{parentName:"ol"},"String Handling: When ",(0,a.kt)("inlineCode",{parentName:"li"},"SheetData")," is a string, a ",(0,a.kt)("inlineCode",{parentName:"li"},"try...catch")," block safeguards the parsing process. We attempt to parse the string into a valid JSON object using ",(0,a.kt)("inlineCode",{parentName:"li"},"JSON.parse"),". This ensures consistency in the data structure."),(0,a.kt)("li",{parentName:"ol"},"Error Management: The ",(0,a.kt)("inlineCode",{parentName:"li"},"catch")," block is currently a placeholder for error handling logic (e.g., logging the error) which is crucial for debugging purposes."),(0,a.kt)("li",{parentName:"ol"},"Key Quote Removal: Finally, a regular expression (",(0,a.kt)("inlineCode",{parentName:"li"},'/\\"([^"]+)":/g'),") addresses the core issue. It replaces all instances of key names enclosed in double quotes (e.g., ",(0,a.kt)("inlineCode",{parentName:"li"},'"name"'),") with just the key name itself (e.g., ",(0,a.kt)("inlineCode",{parentName:"li"},"name:"),"). This transformation aligns the format with GraphQL mutation requirements.")),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"}," Replace ",(0,a.kt)("inlineCode",{parentName:"p"},"SheetData")," with the actual variable name holding your JSON data.")),(0,a.kt)("p",null,"Screenshot below with Simple JS handling -"),(0,a.kt)("h4",{id:"code-1"},"Code"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},' output = JSON.stringify(SheetData).replace(/"([^"]+)":/g, \'$1:\')\n')),(0,a.kt)("figure",null,(0,a.kt)(i.Z,{src:"/img/app-scripting-and-code/json-graphql-mutation/json-graphql-mutation-js.png",alt:"Handling Mutation with Simple JS code.",mdxType:"Thumbnail"}),(0,a.kt)("figcaption",{align:"center"},(0,a.kt)("i",null,"Handling Mutation with Simple JS code."))),(0,a.kt)("h2",{id:"considerations"},"Considerations"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Error Handling: While not explicitly implemented in the provided code, incorporating robust error handling is essential. This can involve logging errors for debugging or throwing specific errors to be handled by the calling code."),(0,a.kt)("li",{parentName:"ul"},"Customization: The code snippet can be customized to fit your specific needs. For instance, you might want to modify the error handling behavior or adapt the regular expression to handle more complex JSON structures.")))}m.isMDXComponent=!0}}]);